
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <style>
            .columnAlignTop {
                vertical-align: text-top
            }
            .rightAlign {
                float: right
            }
            .ratingParentTable {
                width: 100%
            }
            .line {
                width:100%; height: 2px; background-color: black
            }
        </style>
    </h:head>

    <h:body>
        <f:view>
            <h2>#{messages.viewTask}</h2>
            <h:form enctype="multipart/form-data" prependId="false" id="base">

                <table border="1">
                    <thead>
                        <td>
                            #{messages.project}
                        </td>
                    </thead>
                    <tr>
                        <td class="columnAlignTop">#{messages.name}</td>
                        <td>
                            #{viewTaskController.task.title}
                        </td>
                    </tr>
                    <tr>
                        <td class="columnAlignTop">#{messages.description}</td>
                        <td>
                            #{viewTaskController.task.description}
                        </td>
                    </tr>
                    <tr>
                        <td class="columnAlignTop">#{messages.targets}</td>
                        <td>
                            #{viewTaskController.task.goals}
                        </td>
                    </tr>
                    <tr>
                        <td class="columnAlignTop">#{messages.workloadEstimation}<em>h</em></td>
                        <td>
                            #{viewTaskController.task.workIntensity}
                        </td>
                    </tr>

                    <tr>
                        <td class="columnAlignTop">#{messages.desiredOutputs}</td>
                        <td>
                            #{viewTaskController.task.outputs}
                        </td>
                    </tr>
                    <tr>
                        <td class="columnAlignTop">#{messages.validFrom}</td>
                        <td>
                            #{viewTaskController.task.validFrom}
                        </td>
                    </tr>
                    <tr>
                        <td class="columnAlignTop">#{messages.validTo}</td>
                        <td>
                            #{viewTaskController.task.validTo}
                        </td>
                    </tr>
                    <tr>
                        <td class="columnAlignTop">#{messages.logonDeadline}</td>
                        <td>
                            #{viewTaskController.task.registrationEnd}
                        </td>
                    </tr>
                    <tr>
                        <td class="columnAlignTop">#{messages.project}</td>
                        <td>
                            #{viewTaskController.task.project.name}
                        </td>
                    </tr>
                    <tr>
                        <td class="columnAlignTop">#{messages.nominatedSubject}</td>
                        <td>    
                            #{viewTaskController.task.subjects}
                        </td>
                    </tr>
                    <tr>
                        <td class="columnAlignTop">#{messages.sources}</td>
                        <td>
                            #{viewTaskController.task.sources}
                        </td>
                    </tr>
                    <tr>
                        <td class="columnAlignTop">#{messages.attachments}</td>
                        <td>
                            <ui:repeat value="#{viewTaskController.task.attachments}" var="attachment">
                                <h:panelGrid columns="1">
                                    #{attachment.comment}
                                    <p:commandLink value="Download attachment" actionListener="#{viewTaskController.downloadAttachment(attachment)}"/>
                                </h:panelGrid>
                            </ui:repeat>
                        </td>
                    </tr>

                </table>

                <table>
                    <thead>
                        <td>
                            #{messages.roles}
                        </td>
                    </thead>
                    <tr>
                        <td>
                            <ui:repeat value="#{viewTaskController.task.roles}" var="role" varStatus="status">
                                <p:panel toggleable="true" closable="false" toggleSpeed="500" closeSpeed="500">                                         
                                    <f:facet name="header">
                                        #{role.role.name}
                                        <p:spacer width="200" height="5" />
                                        <p:commandButton value="#{messages.applyFor}" action="#{viewTaskController.applyFor(status.index)}"/>
                                    </f:facet>
                                    #{role.role.description}
                                    <ui:repeat value="#{role.skillDtoList}" var="skill">

                                        <h:panelGrid columns="2" class="ratingParentTable">
                                            <!-- -->
                                            <h:panelGroup style="display: inline-block; float:right">
                                                <div style="height: 3px; width: #{5 * 16 - viewTaskController.getSkillLevel(skill.type) * 16}px; float: right" />
                                                <div style="background-color: #{viewTaskController.decideColor(role.role.name, skill.type)}; width:#{viewTaskController.getSkillLevel(skill.type) * 16}px; height:3px; float:right"></div>
                                            </h:panelGroup>

                                            #{skill.type}
                                            <p:rating style="float:right" value="#{skill.rating}" cancel="false" readonly="true" />


                                        </h:panelGrid>
                                    </ui:repeat>

                                </p:panel>
                            </ui:repeat>


                        </td>
                    </tr>
                </table>
            </h:form>




        </f:view>

    </h:body>

</html>